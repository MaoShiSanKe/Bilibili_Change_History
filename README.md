# Bilibili 换一换历史记录

## 描述

为 Bilibili 主页上的「换一换」按钮添加历史回滚功能，支持悬浮预览、快捷键、配置导出/导入、使用统计等。

## 功能

- **回退 / 前进**：在推荐历史记录之间自由导航
- **悬浮预览**：鼠标悬停「回」「行」按钮时，预览该组的视频标题列表
- **历史浏览器**：弹窗展示所有历史快照（含标题与记录时间），可直接跳转到任意一条
- **刷新恢复**：刷新或关闭页面前自动保存当前内容，重新打开后可恢复
- **使用统计**：记录换一换、回退、前进、清除的累计次数，跨会话持久保存
- **快捷键**：可自定义键盘快捷键（支持修饰键组合）及鼠标键触发清除操作
- **配置导出 / 导入**：将所有设置和统计数据导出为 `.json` 文件，方便备份或跨设备迁移
- **恢复默认配置**：一键重置所有设置为默认值
- **可配置历史上限**：默认保留 3 条，支持设置为无限制
- **二次确认**：清除历史时弹窗确认，防止误操作（可关闭）

## 安装

通过 [Greasy Fork](https://greasyfork.org/zh-CN/scripts/502578-bilibili-%E6%8D%A2%E4%B8%80%E6%8D%A2%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95) 安装，需配合 [Tampermonkey](https://www.tampermonkey.net/) 使用。

## 使用说明

安装后，Bilibili 首页「换一换」按钮旁会出现四个新按钮：

| 按钮 | 操作 | 说明 |
|------|------|------|
| 回 | 左键点击 | 回退到上一组推荐内容 |
| 行 | 左键点击 | 前进到下一组推荐内容 |
| 清 | 默认右键点击 | 清除所有历史记录 |
| 设 | 左键点击 | 打开设置面板 |

> 「回」「行」按钮支持悬浮预览，鼠标悬停时会显示该组的视频标题。  
> 「清」按钮的触发鼠标键可在设置中自定义（左键 / 中键 / 右键）。  
> 「设」按钮右上角的数字徽章显示当前会话的历史记录条数（可关闭）。

## 设置面板

点击「设」按钮打开，分为三个标签页：

**常规**
- 自动删除超出历史上限的记录（开启时历史上限生效）
- 清除时弹窗二次确认
- 刷新后自动恢复页面内容
- 悬浮预览视频标题
- 「设」按钮显示历史数量徽章
- 历史记录上限（0 = 无限制）

**快捷键**
- 启用 / 关闭快捷键总开关
- 自定义回退、前进、清除的键盘快捷键（点击方框后按键录制）
- 自定义清除按钮的触发鼠标键

**数据与备份**
- 导出配置（含统计数据）为 `.json` 文件
- 导入配置（支持文件选择或拖拽）
- 查看使用统计 / 历史浏览器
- 恢复默认配置

## 更新日志

### 版本 3.0
- 新增配置导出 / 导入（`.json` 文件，含统计数据）
- 新增恢复默认配置
- 新增悬浮预览（回退/前进按钮悬停显示视频标题）
- 新增历史浏览器（弹窗展示所有快照，支持直接跳转）
- 新增使用统计（换一换/回退/前进/清除次数，持久保存）
- 新增刷新恢复（离开页面前自动保存，重新打开可恢复）
- 设置面板改为三标签页（常规 / 快捷键 / 数据与备份）
- 「设」按钮新增历史数量徽章

### 版本 2.0
- 全面替换浏览器原生弹窗为脚本内置弹窗（支持深色模式）
- 新增自定义快捷键（键盘 + 鼠标键）
- 新增清除二次确认（可关闭）
- 新增「设」按钮直接打开设置面板
- 轻量操作改用 Toast 通知

### 版本 1.2
- 脚本可保存当前设置

### 版本 1.1
- 添加可配置的历史记录限制
- 添加自动删除切换功能
- 改善按钮对齐
